/*
 * dd-ui
 * http://clickataxi.github.io/dd-ui/

 * Version: 0.2.8 - 2016-02-12
 * License: MIT
 */
function DatepickerDirective(a,b){var c={restrict:"EA",require:"ngModel",replace:!0,templateUrl:function(a,b){return b.templateUrl||"template/dd-datepicker/dd-datepicker.html"},scope:{ngModel:"=",minuteStep:"=?",showSpinners:"=?",showMeridian:"=?",ngDisabled:"=?",dateDisabled:"&",ngChange:"&"},link:function(c,d,e,f){function g(){var a=b.parse(c.displayModel,c.dateFormat);l(a),o=!1,j(c.ngModel)}function h(a){a.preventDefault(),a.stopPropagation(),c.opened=!0}function i(){j(c.ngModel)}function j(a){c.boostrapDateModel=angular.copy(a)}function k(b){c.displayModel=b?a(b,c.dateFormat):null}function l(a){c.ngModel=a,m()}function m(){c.ngChange&&c.ngChange()}var n=angular.element(d.find(".display-input")),o=!0;c.dateFormat=e.dateFormat||"yyyy-MM-dd",c.parseUserInput=g,c.open=h,i(),c.$watch("boostrapDateModel",function(a,b){l(a),o&&k(a)}),n.on("blur",function(){k(c.ngModel),o=!0,c.$apply()})}};return c}function datepickerParserService(a){function b(b,e){var h=g.test(e);return h||(b=d(b)),f.test(b)?c(b):a.parse(b,e)}function c(a){var b=e(a),c=(new Date).getFullYear(),d=parseInt(b[1])-1,f=parseInt(b[2]);return new Date(c,d,f)}function d(a){return a.replace(h,"$2-$1")}function e(a){return f.exec(a)}var f=/^(0?[1-9]|1[012])[-\/\s]?(0?[1-9]|[12][0-9]|3[01])$/,g=/(MM)[-\/\s](dd)/,h=/(..)[-\/\s]?(..)/,i=this;i.parse=b}function TimepickerDirective(a,b){var c={restrict:"A",require:"ngModel",replace:!0,scope:{ngModel:"=",minuteStep:"=?",isDateType:"=?"},link:function(a,c,d,e){function f(a){e.$setViewValue(a),e.$render(),g()}function g(){a.ngChange&&a.ngChange()}var h=a.isDateType&&a.ngModel instanceof Date?a.ngModel:new Date;a.minuteStep=a.minuteStep||1,e.$viewChangeListeners.push(function(){a.$eval(d.onChange)}),e.$parsers.push(function(c){return b.toModel(c,a.isDateType,h)}),e.$formatters.push(function(a){return b.toView(a)}),c.on("keydown keypress",function(c){c.which!==KEY_ENTER||e.$modelValue?c.which===KEY_UP?(f(b.changeTime(a.ngModel,a.minuteStep)),c.preventDefault()):c.which===KEY_DOWN&&(f(b.changeTime(a.ngModel,-a.minuteStep)),c.preventDefault()):(f(b.getFormattedTime()),c.preventDefault())}),c.on("blur",function(){f(b.toView(a.ngModel))})}};return c}function timeparserService(a){function b(a,b,c){var d=null;return a?s.test(a)?(d=i(a),f(d,b,c)):(a=m(a),r.test(a)?(d=g(a,r),f(d,b,c)):t.test(a)?(d=h(a,t),f(d,b,c)):null):null}function c(a){return a instanceof Date?e(a):a}function d(b,c){var d=k(m(b)),e=new Date;return e.setHours(d.hours),e.setMinutes(d.minutes+c),a(e,"HH:mm")}function e(b){var c=b||new Date;return a(c,"HH:mm")}function f(a,b,c){if(!a)return null;if(b){var d=a.split(":");return c.setHours(parseInt(d[0])),c.setMinutes(parseInt(d[1])),new Date(c)}return a}function g(a,b){var c=j(a,b),d=k(c[1],c[2]);return l(p(d))}function h(a){var b=k(a,null);return l(p(b))}function i(a){a=m(a);var b=k(a,null);return p(b)}function j(a,b){return b.exec(a)}function k(a,b){"0"===a[0]&&(a=a.replace(/^0/,""));var c=parseInt(a),d=0,e=0;return"0"===a[0]?e=parseInt(a):24>=c&&a.length<=2?d=c:c>24&&999>=c?(d=parseInt(a[0]),e=parseInt(a.substr(1,3))):c>24&&9999>=c&&(d=parseInt(a.substr(0,2)),e=parseInt(a.substr(2,4))),"p"===b&&(d+=12),{hours:d,minutes:e}}function l(a){return s.test(a)?a:null}function m(b){return b instanceof Date&&(b=a(b,"HH:mm")),b||(b="00:00"),b.trim().toLowerCase().replace(".","").replace(":","")}function n(a){return 10>a?"0"+a:a.toString()}function o(a){return 10>a?"0"+a:a.toString()}function p(a){return n(a.hours)+":"+o(a.minutes)}var q=this,r=/^(\d+)(a|p)$/,s=/^([0-9]|0[0-9]|1[0-9]|2[0-3])[.:][0-5][0-9]$/,t=/^[0-9]+$/;q.toModel=b,q.toView=c,q.changeTime=d,q.getFormattedTime=e}angular.module("dd.ui",["dd.ui.arrow-key-nav","dd.ui.busy-element","dd.ui.datetimepicker","dd.ui.dd-datepicker","dd.ui.dd-datetimepicker","dd.ui.dd-timepicker","dd.ui.lookup","dd.ui.validation.phone","dd.ui.validation.sameAs","dd.ui.validation"]),angular.module("dd.ui.arrow-key-nav",[]).directive("ddArrowKeyNav",["$document",function(a){return{restrict:"EA",link:function(b,c,d,e){function f(){var a=h(!0);a&&a.focus()}function g(){var a=h();a&&a.focus()}function h(b){var c=j();b&&c.reverse();var d=c?c.indexOf(a[0].activeElement):-1;if(-1!==d){var e=c.slice(d+1).find(i);return e||(e=c.slice(0,d).find(i)),e}}function i(a){return $(a).hasClass(l)}function j(){return $(c).find("*").filter(function(a,b){return k(b)}).toArray()}function k(a){var b=$(a),c=a.nodeName.toLowerCase(),d=b.attr("tabindex");return!a.disabled&&"disabled"!==b.attr("disabled")&&!b.hasClass("disabled")&&(/input|select|textarea|button|object/.test(c)?!0:"a"===c||"area"===c?a.href||!isNaN(d):!isNaN(d))&&!b["area"===c?"parents":"closest"](":hidden").length}var l="arrow-key-nav";c.on("keydown",function(a){(!d.arrowKeyModifier||a[d.arrowKeyModifier.toLowerCase()+"Key"])&&(38===a.keyCode?(a.preventDefault(),f()):40===a.keyCode&&(a.preventDefault(),g()))})}}}]),angular.module("dd.ui.busy-element",[]).directive("busyElement",["$parse","$timeout","$rootScope",function(a,b,c){return{restrict:"EA",replace:!0,templateUrl:"template/busy-element/busy-element.html",scope:{busy:"=?",status:"=?",timeout:"=?"},link:function(a,c,d){function e(){var b=d.busyElement?angular.element(d.busyElement):c.parent(),e=b.offset();c.offset(e),a.width=b.innerWidth(),a.height=b.innerHeight(),a.marginLeft=b.css("padding-left"),a.marginTop=b.css("padding-top")}e(),a.$watch("status",function(){e(),null!=a.status&&(a.busy=!1,a.statusClass=a.status,0!==a.timeout&&b(function(){a.status=null},a.timeout?a.timeout:500))})}}}]),angular.module("dd.ui.datetimepicker",["ui.bootstrap"]).directive("datetimepicker",["$document",function(a){return{restrict:"EA",require:"ngModel",templateUrl:function(a,b){return b.templateUrl||"template/datetimepicker/datetimepicker.html"},scope:{ngModel:"=",minuteStep:"=?",showSpinners:"=?",showMeridian:"=?",ngDisabled:"=?",dateDisabled:"&"},link:function(b,c,d,e){var f=!0,g=c.children().eq(0).children()[0];e.$viewChangeListeners.push(function(){b.$eval(d.ngChange)}),b.$watch("ngModel",function(c){if(!g.contains(a[0].activeElement)){if(null==c||""===c){if(!f)return;c=new Date,c.setHours(0,0,0,0)}c=new Date(c),b.time=c,f&&(b.ngModel||(b.ngModel=new Date(c)),f=!1)}},!0),b.dateChange=function(){var a=b.time;b.ngModel&&(b.ngModel.setHours(a.getHours(),a.getMinutes(),0,0),e.$setViewValue(b.ngModel))},b.timeChange=function(){if(b.ngModel&&b.time){b.ngModel instanceof Date||(b.ngModel=new Date(b.ngModel));var a=new Date(b.ngModel);a.setHours(b.time.getHours(),b.time.getMinutes(),0,0),e.$setViewValue(a)}},b.open=function(a){a.preventDefault(),a.stopPropagation(),b.opened=!0},function(){void 0===b.minuteStep&&(b.minuteStep=1),void 0===b.showSpinners&&(b.showSpinners=!0)}()}}}]),angular.module("dd.ui.dd-datepicker",["ui.bootstrap"]).directive("ddDatepicker",DatepickerDirective).service("datepickerParserService",datepickerParserService),DatepickerDirective.$inject=["dateFilter","datepickerParserService"],datepickerParserService.$inject=["dateParser"],angular.module("dd.ui.dd-datetimepicker",["ui.bootstrap"]).directive("ddDatetimepicker",["$timeout","dateFilter",function(a,b){return{restrict:"EA",require:"ngModel",templateUrl:function(a,b){return b.templateUrl||"template/dd-datetimepicker/dd-datetimepicker.html"},scope:{ngModel:"=",minuteStep:"=?",showMeridian:"=?",ngDisabled:"=?",dateDisabled:"&",ngChange:"&?",dateFormat:"@"},link:function(c,d,e,f){function g(){c.ngModel&&c.time&&(k(c.time),i(c.ngModel)),m()}function h(){if(c.ngModel&&c.time){l();var a=new Date(c.ngModel);a.setHours(c.time.getHours(),c.time.getMinutes(),0,0),k(a),i(a)}m()}function i(a){f.$setViewValue(a)}function j(){c.time=angular.copy(c.ngModel)}function k(a){l(),c.ngModel.setHours(a.getHours(),a.getMinutes(),0,0)}function l(){c.ngModel instanceof Date||(c.ngModel=new Date(c.ngModel)),c.time instanceof Date||(c.time=new Date(c.time))}function m(){c.ngChange&&c.ngChange()}function n(a,b){var d=a.getHours()-b.getHours(),e=c.ngModel.getDate();-23===d?(c.ngModel.setDate(e+1),o()):23===d&&(c.ngModel.setDate(e-1),o())}function o(){var b=d.find(".datepicker-input.display-input");p(b),b.css("background-color","rgba(0, 128, 0, 0.15)"),a(function(){b.css("background-color","#FFF")},500)}function p(a){var d=c.dateFormat||"yyyy-MM-dd";a.val(b(c.ngModel,d))}c.dateChange=g,c.timeChange=h,j(),c.$watch("ngModel",function(a){c.ngModel&&c.time&&k(c.time)}),c.$watch("time",function(a,b){a&&b&&c.ngModel&&n(a,b)})}}}]),angular.module("dd.ui.dd-timepicker",[]).directive("ddTimepicker",TimepickerDirective).service("timeparserService",timeparserService);var KEY_ENTER=13,KEY_UP=38,KEY_DOWN=40;TimepickerDirective.$inject=["dateFilter","timeparserService"],timeparserService.$inject=["dateFilter"],angular.module("dd.ui.lookup",["ui.bootstrap"]).directive("ddLookup",["$http","$timeout",function(a,b){return{restrict:"EA",require:"ngModel",scope:{ngModel:"=",url:"=",lookupParams:"=?",lookupFormat:"&",ngDisabled:"=?",lookupOnSelect:"&",lookupResponseTransform:"&"},templateUrl:function(a,b){return b.templateUrl||"template/lookup/lookup.html"},link:function(c,d,e,f){if(c.isBusy=!1,c.required=e.required,c.placeholder=e.placeholder,e.lookupAddon){var g=angular.element('<span class="input-group-addon"></span>');g.append(angular.element(e.lookupAddon));var h=d.find(".input-group");h.prepend(g);var i=g.outerWidth(),j=d.find(".lookup-no-results");j.css("margin-left",i),b(function(){var a=d.find(".dropdown-menu");a.css("width","calc(100% - "+i+"px)")})}f.$formatters.push(function(a){return a}),c.getItems=function(b){var d=c.lookupParams||{};return d.query=encodeURIComponent(b),d.limit=10,c.isBusy=!0,a({method:"GET",url:c.url,params:d}).then(function(a){return c.isBusy=!1,e.lookupResponseTransform?c.lookupResponseTransform({$response:a.data}):a.data},function(){c.isBusy=!1})},c.clear=function(){c.ngDisabled||(c.ngModel=null,d.find("input").val(""),f.$setDirty(!0),c.noResults=!1)},c.getLabel=function(a){if(!a)return null;var b;return b=e.lookupFormat?c.lookupFormat({$item:a}):a.name},c.onSelect=function(a,d,e){f.$setDirty(!0),b(c.lookupOnSelect)}}}}]);var PHONE_REGEXP=/^\+\d{10,14}$/,PHONE_COUNTRY_CODE_REGEXP=/^\+\d{1,3}$/,PHONE_WO_COUNTRY_CODE_REGEXP=/^\d{7,13}$/;angular.module("dd.ui.validation.phone",[]).directive("phone",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){return a||""===a?(""===a||PHONE_REGEXP.test(a)?d.$setValidity("phone",!0):d.$setValidity("phone",!1),a):a}d.$parsers.unshift(e),d.$formatters.unshift(e)}}}).directive("phoneCountryCode",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){return a||""===a?(""===a||PHONE_COUNTRY_CODE_REGEXP.test(a)?d.$setValidity("phoneCountryCode",!0):d.$setValidity("phoneCountryCode",!1),a):a}d.$parsers.unshift(e),d.$formatters.unshift(e)}}}).directive("phoneWoCountryCode",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){return a||""===a?(""===a||PHONE_WO_COUNTRY_CODE_REGEXP.test(a)?d.$setValidity("phoneWoCountryCode",!0):d.$setValidity("phoneWoCountryCode",!1),a):a}d.$parsers.unshift(e),d.$formatters.unshift(e)}}}),angular.module("dd.ui.validation.sameAs",[]).directive("sameAs",function(){return{require:"ngModel",link:function(a,b,c,d){function e(b){var c=a.sameAs;return c?b===c?(d.$setValidity("sameAs",!0),b):void d.$setValidity("sameAs",!1):b}d.$parsers.unshift(e),d.$formatters.unshift(e),a.$watch("sameAs",function(){e(d.$modelValue)})},scope:{sameAs:"="}}}),angular.module("dd.ui.validation",["dd.ui.validation.phone","dd.ui.validation.sameAs"]);