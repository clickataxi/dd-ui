/*
 * dd-ui
 * http://clickataxi.github.io/dd-ui/

 * Version: 0.2.2 - 2015-11-25
 * License: MIT
 */
angular.module("dd.ui",["dd.ui.tpls","dd.ui.busy-element","dd.ui.datetimepicker","dd.ui.lookup","dd.ui.validation.phone","dd.ui.validation.sameAs","dd.ui.validation"]),angular.module("dd.ui.tpls",["template/busy-element/busy-element.html","template/datetimepicker/datetimepicker.html","template/lookup/lookup.html"]),angular.module("dd.ui.busy-element",[]).directive("busyElement",["$parse","$timeout","$rootScope",function(a,b,c){return{restrict:"EA",replace:!0,templateUrl:"template/busy-element/busy-element.html",scope:{busy:"=?",status:"=?",timeout:"=?"},link:function(a,c,d){function e(){var b=d.busyElement?angular.element(d.busyElement):c.parent(),e=b.offset();c.offset(e),a.width=b.innerWidth(),a.height=b.innerHeight(),a.marginLeft=b.css("padding-left"),a.marginTop=b.css("padding-top")}e(),a.$watch("status",function(){e(),null!=a.status&&(a.busy=!1,a.statusClass=a.status,0!==a.timeout&&b(function(){a.status=null},a.timeout?$scope.timeout:500))})}}}]),angular.module("dd.ui.datetimepicker",["ui.bootstrap"]).directive("datetimepicker",["$document",function(a){return{restrict:"EA",require:"ngModel",templateUrl:function(a,b){return b.templateUrl||"template/datetimepicker/datetimepicker.html"},scope:{ngModel:"=",minuteStep:"=?",showSpinners:"=?",showMeridian:"=?",ngDisabled:"=?",dateDisabled:"&"},link:function(b,c,d,e){var f=!0,g=c.children().eq(0).children()[0];e.$viewChangeListeners.push(function(){b.$eval(d.ngChange)}),b.$watch("ngModel",function(c){if(!g.contains(a[0].activeElement)){if(null==c||""===c){if(!f)return;c=new Date,c.setHours(0,0,0,0)}c=new Date(c),b.time=c,f&&(b.ngModel||(b.ngModel=new Date(c)),f=!1)}},!0),b.dateChange=function(){var a=b.time;b.ngModel&&(b.ngModel.setHours(a.getHours(),a.getMinutes(),0,0),e.$setViewValue(b.ngModel))},b.timeChange=function(){if(b.ngModel&&b.time){b.ngModel instanceof Date||(b.ngModel=new Date(b.ngModel));var a=new Date(b.ngModel);a.setHours(b.time.getHours(),b.time.getMinutes(),0,0),e.$setViewValue(a)}},b.open=function(a){a.preventDefault(),a.stopPropagation(),b.opened=!0},function(){void 0===b.minuteStep&&(b.minuteStep=1),void 0===b.showSpinners&&(b.showSpinners=!0)}()}}}]),angular.module("dd.ui.lookup",["ui.bootstrap"]).directive("ddLookup",["$http","$timeout",function(a,b){return{restrict:"EA",require:"ngModel",scope:{ngModel:"=",url:"=",lookupParams:"=?",lookupFormat:"&",ngDisabled:"=?",lookupOnSelect:"&"},templateUrl:function(a,b){return b.templateUrl||"template/lookup/lookup.html"},link:function(c,d,e,f){if(c.isBusy=!1,c.required=e.required,c.placeholder=e.placeholder,e.lookupAddon){var g=angular.element('<span class="input-group-addon"></span>');g.append(angular.element(e.lookupAddon));var h=d.find(".input-group");h.prepend(g);var i=g.outerWidth(),j=d.find(".lookup-no-results");j.css("margin-left",i),b(function(){var a=d.find(".dropdown-menu");a.css("width","calc(100% - "+i+"px)")})}f.$formatters.push(function(a){return a}),c.getItems=function(b){var d=c.lookupParams||{};return d.query=encodeURIComponent(b),d.limit=10,c.isBusy=!0,a({method:"GET",url:c.url,params:d}).then(function(a){return c.isBusy=!1,a.data},function(){c.isBusy=!1})},c.clear=function(){c.ngDisabled||(c.ngModel=null,d.find("input").val(""),f.$setDirty(!0),c.noResults=!1)},c.getLabel=function(a){if(!a)return null;var b;return b=e.lookupFormat?c.lookupFormat({$item:a}):a.name},c.onSelect=function(a,d,e){f.$setDirty(!0),b(c.lookupOnSelect)}}}}]);var PHONE_REGEXP=/^\+\d{10,14}$/,PHONE_COUNTRY_CODE_REGEXP=/^\+\d{1,3}$/,PHONE_WO_COUNTRY_CODE_REGEXP=/^\d{7,13}$/;angular.module("dd.ui.validation.phone",[]).directive("phone",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){return a||""===a?(""===a||PHONE_REGEXP.test(a)?d.$setValidity("phone",!0):d.$setValidity("phone",!1),a):a}d.$parsers.unshift(e),d.$formatters.unshift(e)}}}).directive("phoneCountryCode",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){return a||""===a?(""===a||PHONE_COUNTRY_CODE_REGEXP.test(a)?d.$setValidity("phoneCountryCode",!0):d.$setValidity("phoneCountryCode",!1),a):a}d.$parsers.unshift(e),d.$formatters.unshift(e)}}}).directive("phoneWoCountryCode",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){return a||""===a?(""===a||PHONE_WO_COUNTRY_CODE_REGEXP.test(a)?d.$setValidity("phoneWoCountryCode",!0):d.$setValidity("phoneWoCountryCode",!1),a):a}d.$parsers.unshift(e),d.$formatters.unshift(e)}}}),angular.module("dd.ui.validation.sameAs",[]).directive("sameAs",function(){return{require:"ngModel",link:function(a,b,c,d){function e(b){var c=a.sameAs;return c?b===c?(d.$setValidity("sameAs",!0),b):void d.$setValidity("sameAs",!1):b}d.$parsers.unshift(e),d.$formatters.unshift(e),a.$watch("sameAs",function(){e(d.$modelValue)})},scope:{sameAs:"="}}}),angular.module("dd.ui.validation",["dd.ui.validation.phone","dd.ui.validation.sameAs"]),angular.module("template/busy-element/busy-element.html",[]).run(["$templateCache",function(a){a.put("template/busy-element/busy-element.html",'<div class="be-container" style="margin-left: -{{ marginLeft }}; margin-top: -{{ marginTop }}">\n<style>\n.be-container {\n    position: absolute;\n    z-index: 1;\n}\n\n.be-overlay {\n    background-color: rgba(255, 255, 255, 0.7);\n    text-align: center;\n}\n\n.be-overlay.success {\n    background-color: rgba(0, 128, 0, 0.15);\n}\n\n.be-overlay.fail {\n    background-color: rgba(128, 0, 0, 0.15);\n}\n\n.be-animate {\n    -webkit-transition:opacity 0.5s;\n    transition:opacity 0.5s;\n    opacity:1;\n}\n\n.be-animate.ng-hide-add, .be-animate.ng-hide-remove {\n    display: block !important;\n}\n.be-animate.ng-hide {\n    opacity:0;\n}\n</style>\n    <div class="be-overlay" ng-show="busy" style="width: {{ width }}px; height: {{ height }}px; line-height: {{ height }}px">\n        <img src="https://drivr.com/img/spinner.gif" />\n    </div>\n    <div class="be-overlay be-animate" ng-show="status" ng-class="statusClass" style="width: {{ width }}px; height: {{ height }}px"></div>\n</div>')}]),angular.module("template/datetimepicker/datetimepicker.html",[]).run(["$templateCache",function(a){a.put("template/datetimepicker/datetimepicker.html",'<div class="form-inline">\n	<div class="form-group timepicker-container">\n		<div timepicker\n			ng-model="time"\n			ng-disabled="ngDisabled"\n			show-meridian="showMeridian"\n			minute-step="minuteStep"\n			ng-change="timeChange()"\n			show-spinners="showSpinners">\n		</div>\n	</div>\n	<div class="form-group datepicker-container">\n		<input class="form-control datepicker-input" type="text" style="width: 100px"\n				datepicker-popup\n				ng-click="open($event)"\n				ng-change="dateChange($event)"\n				is-open="opened"\n				ng-model="ngModel"\n				ng-disabled="ngDisabled"				\n				date-disabled="dateDisabled({date: date, mode: mode})"\n				close-text="Close"\n				show-weeks="showWeeks" />\n	</div>\n</div>')}]),angular.module("template/lookup/lookup.html",[]).run(["$templateCache",function(a){a.put("template/lookup/lookup.html",'<style>\n.lookup-container .input-group {\n  width: 100%;\n}\n.lookup-container .dropdown-menu {\n  border: 1px solid #ccc !important; \n  border-top: none !important; \n  font-size: 11px; \n  padding: 1px !important; \n  max-height: 196px; \n  overflow-y: scroll; \n  overflow-x: hidden; \n  width: 100%;\n}\n.lookup-container input {\n  background-color: #ffe;\n}\n.lookup-container .dropdown-menu > li > a {\n  padding: 5px;\n}\n.lookup-container .lookup-legend div, .lookup-clear div {\n  width: 16px;\n  height: 16px;\n  display: inline-block;\n  vertical-align: middle;\n}\n.lookup-container a.lookup-clear {\n  outline: 0\n}\n.lookup-container .lookup-no-results span {\n  color: #999;\n  font-size: 10px;\n}\n.lookup-container .lookup-legend .lookup-icon {\n  background-image: url(./assets/img/magnifier-small.png);\n}\n.lookup-container .lookup-legend .spinner-icon {\n  background-image: url(./assets/img/spinner.gif);\n  background-size: 16px;\n}\n.lookup-container .lookup-clear .clear-icon {\n  background-image: url(./assets/img/cross-small-white.png); \n  opacity: 0.6;\n}\n.lookup-container .lookup-legend {\n  position: absolute;\n  right: 6px;\n  top: 6px;\n  z-index: 5;\n}\n.lookup-container .lookup-clear {\n  position: absolute;\n  right: 22px;\n  top: 6px;\n  z-index: 5;\n}\n</style>\n\n<div class="lookup-container" ng-cloak>\n  <div class="input-group">\n    <input type="text"\n           ng-model="ngModel"\n           autocomplete="off"\n           typeahead="d as getLabel(d) for d in getItems($viewValue)"\n           typeahead-on-select="onSelect($item, $model, $label)"\n           typeahead-editable="false"\n           typeahead-no-results="noResults"\n           ng-required="required"\n           ng-disabled="ngDisabled"\n           placeholder="{{placeholder}}"\n           class="form-control" />\n    <span class="lookup-legend">\n      <div class="lookup-icon" ng-show="!isBusy"></div>\n      <div class="spinner-icon" ng-show="isBusy"></div>\n    </span>\n    <a class="lookup-clear" ng-click="clear()" tabindex="-1" ng-class="{ \'disabled\' : ngDisabled }">\n      <div class="clear-icon" tooltip="Clear" tooltip-append-to-body="true"></div>\n    </a>\n  </div>\n  <div ng-show="noResults" class="lookup-no-results">\n    <span class="detail"><i class="glyphicon glyphicon-remove"></i> No results found</span>\n  </div>\n</div>')}]);